{% extends 'html.twig' %}

{% set phoneExpr = '^(\\+[0-9]+)? *([0-9] *){5,}$' %}
{% set mailExpr = '^\\S+@\\S+$' %}

{% block content %}
  <h1>Hurtigtest</h1>
  <p class="info">
    Denne siden er fortsatt under utvikling og er ikke tatt i bruk.
  </p>
  <p style="max-width: 80ch;">
    Mi. Duis eget pede. Phasellus arcu tellus, ultricies id, consequat id,
    lobortis nec, diam. Suspendisse sed nunc. Pellentesque id magna. Morbi
    interdum quam at est. Maecenas eleifend mi in urna. Praesent et lectus ac
    nibh luctus viverra. In vel dolor sed nibh sollicitudin tincidunt. Ut
    consequat nisi sit amet nibh. Nunc mi tortor, tristique sit amet, rhoncus
    porta, malesuada elementum, nisi. Integer vitae enim quis risus aliquet
    gravida. Curabitur vel lorem vel erat dapibus lobortis. Donec dignissim
    tellus at arcu. Quisque molestie pulvinar sem.

    Nulla magna neque, ullamcorper tempus, luctus eget, malesuada ut, velit.
    Morbi felis. Praesent in purus at ipsum cursus.
  </p>
  {% if free > 0 %}
    <form
      id="input-form"
      method="POST"
      action="do-submit.php"
      onSubmit="return validateForm()"
    >
      <h2 style="grid-column: 1 / -1; font-weight: bold; text-align: center">
        Personalia
      </h2>
      <label for="input-name">Navn</label>
      <input id="input-name" type="text" name="name" required />
      <label for="input-tlf">Telefon</label>
      <input
        id="input-tlf"
        type="text"
        name="tlf"
        pattern="{{ phoneExpr }}"
        required
      />
      <label for="input-mail">E-post</label>
      <input
        id="input-mail"
        type="text"
        name="mail"
        pattern="{{ mailExpr }}"
        required
      />
      <label for="input-fødselsnummer">Fødselsnummer</label>
      <input
        id="input-fødselsnummer"
        type="text"
        name="fødselsnummer"
        onChange="validateFødselsnummer()"
        required
      />
      <h2 style="grid-column: 1 / -1; text-align: center">Tidspunkt</h2>
      {% for tidspunkt in tidspunkter %}
        {% set labeltext = tidspunkt.weekday ~ ' ' ~ tidspunkt.day ~ '. '
          ~ tidspunkt.month
          ~ '<br/>kl.&nbsp;'
          ~ tidspunkt.startTime
          ~ '&nbsp;-&nbsp;'
          ~ tidspunkt.endTime
        %}
        <div style="grid-column: 1 / -1">
          {% if tidspunkt.paameldte >= tidspunkt.plasser %}
            <input
              id="input-time-{{ tidspunkt.id }}"
              type="radio"
              value="{{ tidspunkt.id }}"
              disabled
            />
            <label for="input-time-{{ tidspunkt.id }}">
              <span>Fullt</span>
              <span>{{ labeltext|raw }}</span>
            </label>
          {% else %}
            <input
              id="input-time-{{ tidspunkt.id }}"
              type="radio"
              name="time"
              value="{{ tidspunkt.id }}"
              onChange="validateRadios();"
            />
            <label for="input-time-{{ tidspunkt.id }}">
              <span style="flex-basis: 100%">{{ labeltext|raw }}</span>
            </label>
          {% endif %}
        </div>
      {% endfor %}
      <p id="input-message" style="display: none; grid-column: 1 / -1;"></p>
      <input type="submit" style="grid-column: 1 / -1;" value="Bestill" />
    </form>
    <script>loadInfo();</script>
  {% else %}
    <p class="info">Det er for øyeblikket ingen ledige tidspunkter</p>
  {% endif %}
{% endblock %}
